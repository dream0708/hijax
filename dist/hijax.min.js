!function(t,e){"function"==typeof define&&define.amd?define("hijacker",[],e):"object"==typeof exports?module.exports=e():t.Hijacker=e()}(this,function(){function t(t,e,o){if(!t||!e||!o||"object"!=typeof o)throw"Missing or invalid Hijacker proxy initialization options";this.name=t,this.condition="function"==typeof e?e:function(t){return e===t},this.callbacks={beforeSend:[],receive:[],complete:[]};for(var n in o)o.hasOwnProperty(n)&&this.callbacks[n].push(o[n]);return this}return t.prototype.fireEvent=function(t,e){var o=this.callbacks[t],n=e.response;if(this.condition(e.url))for(var i=0;i<o.length;i++)o[i].call(this,n,e.statusText,e)},t.prototype.addListener=function(t,e){this.callbacks[t].push(e)},t}),function(t,e){"function"==typeof define&&define.amd?define("hijax",["hijacker"],e):"object"==typeof exports?module.exports=e(require("hijacker")):t.hijax=e(t.Hijacker)}(this,function(t){function e(t,e,o){var n=t;return function(){var i;if("function"!=typeof t)throw t+" is not a function, and cannot be proxied!";return"function"==typeof e&&e.apply(this,arguments),i=n.apply(this,arguments),"function"==typeof o&&o.apply(this,arguments),i}}function o(){this.proxies={},this.active=0}if(window.hijax)return window.hijax;var n,i={UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4};return o.prototype.getXHRMethod=function(t){return window.XMLHttpRequest.prototype[t]},o.prototype.setXHRMethod=function(t,e){window.XMLHttpRequest.prototype[t]=e},o.prototype.proxyXhrMethod=function(t,o,n){var i=e(this.getXHRMethod(t),o,n);this.setXHRMethod(t,i)},o.prototype.createProxy=function(e,o,n){var i=new t(e,o,n);return this.proxies[e]=i,i},o.prototype.set=function(t,e,o){return this.createProxy(t,e,o)},o.prototype.addListener=function(t,e,o){if(!(t in this.proxies))throw t+" proxy does not exist!";this.proxies[t].addListener(e,o)},o.prototype.dispatch=function(t,e,o){var n=this.proxies;for(var i in n)n.hasOwnProperty(i)&&n[i].fireEvent(t,e);"function"==typeof o&&o()},n=window.hijax=new o,n.proxyXhrMethod("open",function(t,e){this.url=e,n.active++,n.dispatch("beforeSend",this)}),n.proxyXhrMethod("send",function(){var t=this,o=function(){n.dispatch("receive",t)},r=function(){t.readyState===i.DONE&&n.dispatch("complete",t,function(){n.active--})},a=function(){t.proxied||("function"==typeof t.onreadystatechange?(t.onreadystatechange=e(t.onreadystatechange,o,r),t.proxied=!0):"function"==typeof t.onload?(t.onload=e(t.onload,o,r),t.proxied=!0):t.readyState===i.LOADING?o():t.readyState===i.DONE&&r())};t.addEventListener("readystatechange",a,!1)}),n});